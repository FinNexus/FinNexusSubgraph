specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
- kind: ethereum/contract
  name: optionOracle
  network: mainnet
  source:
    address: "0x43BD92bF3Bb25EBB3BdC2524CBd6156E3Fdd41F3"
    abi: OptionOracle
  mapping:
    kind: ethereum/events
    apiVersion: 0.0.4
    language: wasm/assemblyscript
    entities:
    - OwnershipTransferred
    abis:
    - name: OptionOracle
      file: ./abis/OptionOracle.json
    - name: OptionManager
      file: ./abis/OptionManager.json
    - name: OptionPool
      file: ./abis/OptionPool.json
    - name: CollateralPool
      file: ./abis/CollateralPool.json
    eventHandlers:
    - event: OwnershipTransferred(indexed address,indexed address)
      handler: handleOwnershipTransferred
    blockHandlers:
    - handler: handleBlock
    file: ./src/mapping.ts

templates:
  - kind: ethereum/contract
    name: OptionManager
    network: mainnet
    source:
      abi: OptionManager
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
      - AddCollateral
      - BuyOption
      - DebugEvent
      - ExerciseOption
      - OwnershipTransferred
      - RedeemCollateral
      - SellOption
      abis:
      - name: OptionManager
        file: ./abis/OptionManager.json
      - name: OptionPool
        file: ./abis/OptionPool.json
      - name: CollateralPool
        file: ./abis/CollateralPool.json
      eventHandlers:
      - event: AddCollateral(indexed address,indexed address,uint256,uint256)
        handler: handleAddCollateral
      - event: BuyOption(indexed address,indexed address,uint256,uint256,uint256)
        handler: handleBuyOption
      - event: DebugEvent(uint256,uint256,uint256)
        handler: handleDebugEvent
      - event: ExerciseOption(indexed address,indexed uint256,uint256,uint256)
        handler: handleExerciseOption
      - event: OwnershipTransferred(indexed address,indexed address)
        handler: handleOwnershipTransferred
      - event: RedeemCollateral(indexed address,address,uint256)
        handler: handleRedeemCollateral
      - event: SellOption(indexed address,indexed uint256,uint256,uint256)
        handler: handleSellOption
      file: ./src/mapping.ts

  - kind: ethereum/contract
    name: OptionPool
    network: mainnet
    source:
      abi: OptionPool
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
      - BurnOption
      - CreateOption
      - DebugEvent
      - OwnershipTransferred
      abis:
      - name: OptionManager
        file: ./abis/OptionManager.json
      - name: OptionPool
        file: ./abis/OptionPool.json
      - name: CollateralPool
        file: ./abis/CollateralPool.json

      eventHandlers:
      - event: BurnOption(indexed address,indexed uint256,uint256)
        handler: handleBurnOption
      - event: CreateOption(indexed address,indexed uint256,uint8,uint32,uint256,uint256,uint256)
        handler: handleCreateOption
      - event: DebugEvent(uint256,uint256,uint256)
        handler: handleDebugEvent
      - event: OwnershipTransferred(indexed address,indexed address)
        handler: handleOwnershipTransferred
      file: ./src/mapping.ts

  - kind: ethereum/contract
    name: CollateralPool
    network: mainnet
    source:
      abi: CollateralPool
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
      - AddFee
      - OwnershipTransferred
      - RedeemFee
      - TransferPayback
      abis:
      - name: OptionManager
        file: ./abis/OptionManager.json
      - name: OptionPool
        file: ./abis/OptionPool.json
      - name: CollateralPool
        file: ./abis/CollateralPool.json

      eventHandlers:
      - event: AddFee(indexed address,uint256)
        handler: handleAddFee
      - event: OwnershipTransferred(indexed address,indexed address)
        handler: handleOwnershipTransferred
      - event: RedeemFee(indexed address,indexed address,uint256)
        handler: handleRedeemFee
      - event: TransferPayback(indexed address,indexed address,uint256)
        handler: handleTransferPayback
      file: ./src/mapping.ts
